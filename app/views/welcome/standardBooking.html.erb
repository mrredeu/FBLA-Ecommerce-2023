<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Moonlight Hotel</title>
        <%= stylesheet_link_tag "booking.css" %>
        <%= javascript_include_tag "booking.js" %>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body class="background">
        <div style="width: 100%; display:flex;">
            <div style="max-width: 20%;">
                <%= image_tag('logo.png', style:"width:100%") %>
            </div>
            <div style="width: 80%;">
                <h1 class="Title"><%= link_to 'Moonlight Hotel', welcome_index_path, style:"text-decoration: none;color: black;"%></h1>
            </div>
        </div>
        <h1 style="text-align:center;margin:0;">Standard Room</h1>
        <div class="slideshow-container">
            <div class="mySlides fade">
                <%=image_tag('standard1.jpg')%>
            </div>

            <div class="mySlides fade">
                <%=image_tag('standard2.jpg')%>
            </div>
            <a class="prev" onclick="changeSlide(-1)">&#10094;</a>
            <a class="next" onclick="changeSlide(1)">&#10095;</a>
        </div>
        <div class="calendar">
            <div class="calendar-container">
                <div class="calendar-input">
                    <label for="check-in">Check-In</label>
                    <input type="text" id="check-in" class="date-input">
                </div>
                <div class="calendar-input">
                    <label for="check-out">Check-Out</label>
                    <input type="text" id="check-out" class="date-input">
                </div>
                <div class="calendar">
                    <div class="calendar-header">
                        <button class="prev-month">&#8249;</button>
                        <h2 class="calendar-title"></h2>
                        <button class="next-month">&#8250;</button>
                    </div>
                    <div class="calendar-body">
                    <div class="calendar-row">
                        <div class="calendar-cell">S</div>
                        <div class="calendar-cell">M</div>
                        <div class="calendar-cell">T</div>
                        <div class="calendar-cell">W</div>
                        <div class="calendar-cell">T</div>
                        <div class="calendar-cell">F</div>
                        <div class="calendar-cell">S</div>
                    </div>
                    </div>
                </div>
            </div>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function() {
                var months = [
                    'January',
                    'February',
                    'March',
                    'April',
                    'May',
                    'June',
                    'July',
                    'August',
                    'September',
                    'October',
                    'November',
                    'December'
                ];

                var currentDate = new Date();
                var currentYear = currentDate.getFullYear();
                var currentMonth = currentDate.getMonth();
                var currentDay = currentDate.getDate();

                var selectedCheckInDate = null;
                var selectedCheckOutDate = null;

                var checkInInput = $('#check-in');
                var checkOutInput = $('#check-out');

                function populateCalendar(month, year) {
                    var monthTitle = document.querySelector('.calendar-title');
                    monthTitle.textContent = months[month];

                    var daysInMonth = new Date(year, month + 1, 0).getDate();
                    var firstDay = new Date(year, month, 1).getDay();
                    var lastDay = new Date(year, month, daysInMonth).getDay();

                    var days = [];

                    for (var i = 1; i <= daysInMonth; i++) {
                        days.push({
                            day: i,
                            month: month,
                            year: year
                        });
                    }

                    for (var i = 0; i < firstDay; i++) {
                        days.unshift(null);
                    }

                    for (var i = lastDay; i < 6; i++) {
                        days.push(null);
                    }

                    var calendarBody = $('.calendar-body');
                    calendarBody.empty();

                    days.forEach(function(day) {
                        var cell = $('<div class="calendar-cell"></div>');

                        if (day === null) {
                            cell.addClass('disabled');
                        } else {
                            cell.text(day.day);

                        if (selectedCheckInDate !== null && selectedCheckOutDate === null) {
                            var checkInDate = new Date(selectedCheckInDate.year,selectedCheckInDate.month,selectedCheckInDate.day
                        );

                        var currentDate = new Date(day.year, day.month, day.day);
                        if (currentDate > checkInDate) {
                            cell.addClass('active');
                        }
                        } else if (selectedCheckInDate === null && selectedCheckOutDate === null) {
                        var currentDate = new Date(day.year, day.month, day.day);

                        if (currentDate.getFullYear() === currentYear &&
                            currentDate.getMonth() === currentMonth &&
                            currentDate.getDate() === currentDay) {
                                cell.addClass('active');
                            }
                        }
                    }

                    cell.on('click', function() {
                        if (selectedCheckInDate === null) {
                            selectedCheckInDate = day;
                            checkInInput.val(months[month] + ' ' + day.day + ', ' + year);
                        } else if (selectedCheckOutDate === null) {
                            selectedCheckOutDate = day;
                            checkOutInput.val(months[month] + ' ' + day.day + ', ' + year);
                        } else {
                            selectedCheckInDate = day;
                            selectedCheckOutDate = null;
                            checkInInput.val(months[month] + ' ' + day.day + ', ' + year);
                            checkOutInput.val('');
                        }
                        populateCalendar(month, year);
                    });
                    calendarBody.append(cell);
                    });
                }

                populateCalendar(currentMonth, currentYear);
                $('.prev-month').on('click', function() {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    populateCalendar(currentMonth, currentYear);
                });

                $('.next-month').on('click', function() {
                    currentMonth++;
                    if (currentMonth > 11){
                        currentMonth = 0;
                        currentYear++;
                    }
                populateCalendar(currentMonth, currentYear);
                });
            });
        </script>
    </body>
</html>
