<script src="https://kit.fontawesome.com/3764241a81.js" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

<body class="background">
  <div class="main">
    <div style="width: 100%; display:flex;">
      <div style="max-width: 20%;">
          <%= image_tag('logo.png', style:"width:100%") %>
      </div>
      <div style="width: 80%;">
          <h1 class="Title">Moonlight Hotel</h1>
      </div>
    </div>
    
    <nav class="navbar">
      <%= link_to 'Rooms', welcome_main_path, class:"navbar-item"%>
      <%= link_to 'Attrations', welcome_attractions_path, class:"navbar-item"%>
      <%= link_to 'About Us', welcome_aboutUs_path, class:"navbar-item"%>
    </nav>
  </div>

  <h1 style="text-align:center;margin:0;" id='roomType'></h1>
  <div class="slideshow-container">
    <div class="mySlides fade">
      <%=image_tag('standard1.jpg')%>
    </div>
    <div class="mySlides fade">
      <%=image_tag('standard2.jpg')%>
    </div>
      <a class="prev" onclick="changeSlide(-1)">&#10094;</a>
      <a class="next" onclick="changeSlide(1)">&#10095;</a>
    </div> 
    <div class="information">
      <div>
        <i class="range-square"></i>
        <p id='sq-ft'></p>
      </div>
      <div>
        <div class='svgFile'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Pro 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M32 32c17.7 0 32 14.3 32 32V320H288V160c0-17.7 14.3-32 32-32H544c53 0 96 43 96 96V448c0 17.7-14.3 32-32 32s-32-14.3-32-32V416H352 320 64v32c0 17.7-14.3 32-32 32s-32-14.3-32-32V64C0 46.3 14.3 32 32 32zm144 96a80 80 0 1 1 0 160 80 80 0 1 1 0-160z"/></svg>
        </div>
        <p id='beds'></p>
      </div>
      <div>
        <div class='svgFile'>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Pro 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/></svg>
        </div>
        <p id='sleeps'></p>
      </div>
      <p>Free Internet Access</p>
      <p>Free Parking</p>
      <p>Pool</p>
      <p id='base_price'></p>
      <p id='full_price'></p>
    </div>
  </div>
</body>

<%= render "form", room: @room %>
<script>
  function updatePulledInfo (){
    var params = ['roomType', 'bPrice', 'fPrice']
    var ids = ["roomType", "base_price", "full_price"];
    for (var i = 0; i < ids.length; i++) {
      var element = document.getElementById(ids[i]);
      var urlParams = new URLSearchParams(window.location.search);
      var getInfo = urlParams.get(params[i]);
      if (getInfo != element.textContent){
        element.textContent = getInfo;
        window.localStorage.setItem(ids[i], getInfo);
      }else if (localStorage.getItem(ids[i]) != null) {
        element.textContent = window.localStorage.getItem(ids[i]);
      }else{
        element.textContent = getInfo;
        window.localStorage.setItem(ids[i], getInfo);
      }
    }
  }
  function updateOtherInfo() {
    var idFields = ['roomTypeField', 'totalPriceField'];
    var idText = ['roomType', 'full_price'];
    var field = document.getElementById('roomTypeField');
    var text = document.getElementById('roomType').textContent;
    field.value = text;
    var field = document.getElementById('totalPriceField');
    var text = document.getElementById('full_price').textContent;
    text = text.slice(-3);
    field.value = text;
    var roomFields = ['#sq-ft', '#beds', '#sleeps']
    var roomStandard = ['430 sq ft', '1 King Bed', 'Sleeps 2']
    var roomDeluxe = ['560 sq ft', '2 Queen Beds', 'Sleeps 4']
    var roomConnecting = ['650 sq ft', '4 Queen Beds', 'Sleeps 8']
    var roomSuite = ['780 sq ft', '1 King Beds', 'Sleeps 2']
    if (localStorage.getItem('roomType') == 'Standard Room') {
      for (var i = 0; i < 3; i++){
        p = document.querySelector(roomFields[i]);
        p.textContent = roomStandard[i]
      }
    }else if (localStorage.getItem('roomType') == 'Deluxe Room') {
      for (var i = 0; i < 3; i++){
        p = document.querySelector(roomFields[i]);
        p.textContent = roomDeluxe[i]
      }
    }else if (localStorage.getItem('roomType') == 'Connecting Room') {
      for (var i = 0; i < 3; i++){
        p = document.querySelector(roomFields[i]);
        p.textContent = roomConnecting[i]
      }
    }else if (localStorage.getItem('roomType') == 'Suite Room') {
      for (var i = 0; i < 3; i++){
        p = document.querySelector(roomFields[i]);
        p.textContent = roomSuite[i]
      }
    }
  }
  async function runInfo() {
    await updatePulledInfo();
    await updateOtherInfo();
  }
  runInfo();
</script>
<%= javascript_include_tag "slider.js" %>